<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comparar Hardware - T-Hardia 2025</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/animations.css">
    <link rel="stylesheet" href="css/comparison.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Header -->
    <header class="main-header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <h1 class="glitch-text">T-Hardia</h1>
                    <span class="logo-subtitle">2025</span>
                </div>
                <nav class="main-nav">
                    <ul class="nav-list">
                        <li><a href="index.html" class="nav-link">Inicio</a></li>
                        <li><a href="hardware-comparison.html" class="nav-link active">Comparar</a></li>
                        <li><a href="survey.html" class="nav-link">Encuestas</a></li>
                        <li><a href="blog.html" class="nav-link">Blog</a></li>
                         <li>
                        <span id="user-greeting" style="display:none; color: var(--light); font-weight: 600;"></span>
                    </li>

                    <!-- üîê Bot√≥n Login -->
                    <li id="login-nav">
                        <a href="login.html" class="nav-link btn-login">Login</a>
                    </li>

                    <!-- üö™ Bot√≥n Logout -->
                    <li id="logout-nav" style="display:none;">
                        <button id="logout-btn" class="btn btn-primary">Cerrar sesi√≥n</button>
                    </li>
                </ul>
                    </ul>
                    <div class="mobile-menu-toggle">
                        <i class="fas fa-bars"></i>
                    </div>
                </nav>
            </div>
        </div>
    </header>

    <main class="main-content">
        <section class="comparison-hero">
            <div class="container">
                <h1>Comparador <span class="highlight">Inteligente</span></h1>
                <p>Ingresa los componentes que deseas comparar y nuestra IA te dar√° un an√°lisis detallado</p>
            </div>
        </section>

        <section class="comparison-section">
            <div class="container">
                <div class="comparison-form-container">
                    <form id="comparison-form" class="comparison-form">
                        <div class="form-header">
                            <h2><i class="fas fa-balance-scale"></i> Comparar Componentes</h2>
                            <p>Ingresa los nombres completos de los componentes que deseas comparar</p>
                        </div>
                        
                        <div class="form-group">
                            <label for="component1">
                                <i class="fas fa-microchip"></i>
                                Componente 1
                            </label>
                            <input 
                                type="text" 
                                id="component1" 
                                placeholder="Ej: Intel Core i9-13900K" 
                                required
                            >
                            <div class="suggestions" id="suggestions1"></div>
                        </div>
                        
                        <div class="form-group">
                            <label for="component2">
                                <i class="fas fa-microchip"></i>
                                Componente 2
                            </label>
                            <input 
                                type="text" 
                                id="component2" 
                                placeholder="Ej: AMD Ryzen 9 7950X" 
                                required
                            >
                            <div class="suggestions" id="suggestions2"></div>
                        </div>
                        
                        <div class="form-group">
                            <label for="category">
                                <i class="fas fa-tags"></i>
                                Categor√≠a (Opcional)
                            </label>
                            <select id="category">
                                <option value="">Detectar autom√°ticamente</option>
                                <option value="cpu">Procesador (CPU)</option>
                                <option value="gpu">Tarjeta Gr√°fica (GPU)</option>
                                <option value="ram">Memoria RAM</option>
                                <option value="storage">Almacenamiento</option>
                                <option value="motherboard">Placa Base</option>
                                <option value="psu">Fuente de Poder</option>
                            </select>
                        </div>
                        
                        <button type="submit" class="btn btn-primary btn-large btn-block">
                            <span class="btn-text">Comparar con IA</span>
                            <span class="btn-loading" style="display: none;">
                                <i class="fas fa-spinner fa-spin"></i>
                            </span>
                        </button>
                    </form>
                </div>

                <div class="comparison-results" id="comparison-results" style="display: none;">
                    <div class="results-header">
                        <h2>Resultados de Comparaci√≥n</h2>
                        <button class="btn btn-secondary" onclick="clearResults()">
                            <i class="fas fa-times"></i> Nueva Comparaci√≥n
                        </button>
                    </div>
                    <div id="comparison-content"></div>
                </div>
            </div>
        </section>

        <!-- Ejemplos de comparaci√≥n -->
        <section class="examples-section">
            <div class="container">
                <div class="section-header">
                    <h2>Ejemplos <span class="highlight">Populares</span></h2>
                    <p>Prueba estas comparaciones sugeridas</p>
                </div>
                <div class="examples-grid">
                    <div class="example-card" onclick="loadExample('Intel Core i9-13900K', 'AMD Ryzen 9 7950X')">
                        <h3>CPU High-End</h3>
                        <p>Intel vs AMD</p>
                    </div>
                    <div class="example-card" onclick="loadExample('NVIDIA RTX 4090', 'AMD RX 7900 XTX')">
                        <h3>GPU Premium</h3>
                        <p>NVIDIA vs AMD</p>
                    </div>
                    <div class="example-card" onclick="loadExample('Samsung 980 PRO 2TB', 'WD Black SN850X 2TB')">
                        <h3>SSD NVMe</h3>
                        <p>Samsung vs WD</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="main-footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-column">
                    <h3>T-Hardia 2025</h3>
                    <p>La plataforma definitiva para entusiastas del hardware.</p>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-github"></i></a>
                        <a href="#"><i class="fab fa-linkedin"></i></a>
                    </div>
                </div>
                <div class="footer-column">
                    <h4>Plataforma</h4>
                    <ul>
                        <li><a href="hardware-comparison.html">Comparador IA</a></li>
                        <li><a href="survey.html">Encuestas</a></li>
                        <li><a href="blog.html">Blog</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h4>Soporte</h4>
                    <ul>
                        <li><a href="#">Ayuda</a></li>
                        <li><a href="#">Contacto</a></li>
                        <li><a href="#">Privacidad</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 T-Hardia. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

    <script src="js/main.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/protect.js"></script>

<script>
    // ===============================
    // üîπ CONFIGURACI√ìN DEL BACKEND
    // ===============================
    const API_URL = "http://t-hardia-2025-production.up.railway.app/api/v1/comparisons/"; 
    // ‚ö†Ô∏è En producci√≥n cambia a tu dominio Vercel:
    // const API_URL = "https://t-hardia-api.vercel.app/api/v1/comparisons/";

    // ===============================
    // üîπ FUNCIONES DE INTERFAZ
    // ===============================
    function loadExample(comp1, comp2) {
        document.getElementById('component1').value = comp1;
        document.getElementById('component2').value = comp2;
        document.getElementById('component1').focus();
    }

    function clearResults() {
        document.getElementById('comparison-results').style.display = 'none';
        document.getElementById('comparison-form').scrollIntoView({ behavior: 'smooth' });
    }

    // ===============================
    // üîπ AUTOCOMPLETADO
    // ===============================
    const componentSuggestions = [
        "Intel Core i9-13900K", "Intel Core i7-13700K", "Intel Core i5-13600K",
        "AMD Ryzen 9 7950X", "AMD Ryzen 7 7800X3D", "AMD Ryzen 5 7600X",
        "NVIDIA GeForce RTX 4090", "NVIDIA GeForce RTX 4080", "NVIDIA GeForce RTX 4070 Ti",
        "AMD Radeon RX 7900 XTX", "AMD Radeon RX 7800 XT", "AMD Radeon RX 7700 XT",
        "Samsung 980 PRO 2TB", "WD Black SN850X 2TB", "Crucial P5 Plus 2TB",
        "Corsair Vengeance LPX 32GB", "G.Skill Trident Z5 32GB", "Kingston Fury Beast 32GB"
    ];

    function setupAutocomplete(inputId, suggestionsId) {
        const input = document.getElementById(inputId);
        const suggestionsDiv = document.getElementById(suggestionsId);
        
        input.addEventListener('input', function() {
            const value = this.value.toLowerCase();
            suggestionsDiv.innerHTML = '';
            
            if (value.length > 2) {
                const filtered = componentSuggestions.filter(item => 
                    item.toLowerCase().includes(value)
                );
                
                if (filtered.length > 0) {
                    filtered.slice(0, 5).forEach(item => {
                        const div = document.createElement('div');
                        div.className = 'suggestion-item';
                        div.textContent = item;
                        div.addEventListener('click', () => {
                            input.value = item;
                            suggestionsDiv.innerHTML = '';
                        });
                        suggestionsDiv.appendChild(div);
                    });
                    suggestionsDiv.style.display = 'block';
                } else {
                    suggestionsDiv.style.display = 'none';
                }
            } else {
                suggestionsDiv.style.display = 'none';
            }
        });

        document.addEventListener('click', function(e) {
            if (!input.contains(e.target) && !suggestionsDiv.contains(e.target)) {
                suggestionsDiv.style.display = 'none';
            }
        });
    }

    // ===============================
    // üîπ ENV√çO DEL FORMULARIO
    // ===============================
    async function handleComparisonSubmit(e) {
    e.preventDefault();

    const component1 = document.getElementById('component1').value.trim();
    const component2 = document.getElementById('component2').value.trim();
    const category = document.getElementById('category').value || null;
    
    // Correcci√≥n: Obtener correctamente los elementos del bot√≥n
    const btn = document.querySelector('.btn-primary');
    const btnText = btn ? btn.querySelector('.btn-text') : null;
    const btnLoading = btn ? btn.querySelector('.btn-loading') : null;

    if (!component1 || !component2) {
        alert("Por favor, ingresa ambos componentes antes de comparar.");
        return;
    }

    // Mostrar carga - con verificaci√≥n de elementos
    if (btn) btn.disabled = true;
    if (btnText) btnText.style.display = 'none';
    if (btnLoading) btnLoading.style.display = 'inline-block';

    try {
        const response = await fetch(API_URL, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                component1,
                component2,
                user_id: "test_user",
                category
            }),
        });

        const data = await response.json();

        if (!response.ok) {
            throw new Error(data.detail || "Error en el servidor");
        }

        if (data.result) {
            const comparisonContent = document.getElementById("comparison-content");
            if (comparisonContent) {
                comparisonContent.innerHTML = `
                    <div class="comparison-ai-result">
                        <h3>üìä An√°lisis T√©cnico</h3>
                        <div class="comparison-text">${data.result.performance_comparison.replace(/\n/g, "<br>")}</div>
                        <div class="comparison-recommendation">
                            <p><strong>üí° Recomendaci√≥n:</strong> ${data.result.recommendation}</p>
                        </div>
                    </div>
                `;
                
                const comparisonResults = document.getElementById("comparison-results");
                if (comparisonResults) {
                    comparisonResults.style.display = "block";
                    comparisonContent.scrollIntoView({ behavior: "smooth" });
                }
            }
        } else {
            throw new Error("No se recibi√≥ resultado v√°lido desde la IA.");
        }
    } catch (error) {
        console.error("Error:", error);
        alert("‚ùå Error al realizar la comparaci√≥n: " + error.message);
    } finally {
        // Ocultar carga - con verificaci√≥n de elementos
        if (btn) btn.disabled = false;
        if (btnText) btnText.style.display = 'inline-block';
        if (btnLoading) btnLoading.style.display = 'none';
    }
}


    // ===============================
    // üîπ INICIALIZACI√ìN
    // ===============================
    document.addEventListener("DOMContentLoaded", function () {
        setupAutocomplete("component1", "suggestions1");
        setupAutocomplete("component2", "suggestions2");

        const form = document.getElementById("comparison-form");
        form.addEventListener("submit", handleComparisonSubmit);
    });
</script>

<script type="text/javascript">
  (function(d, t) {
      var v = d.createElement(t), s = d.getElementsByTagName(t)[0];
      v.onload = function() {
        window.voiceflow.chat.load({
          verify: { projectID: '68c0d1160c5887433f0bb303' },
          url: 'https://general-runtime.voiceflow.com',
          versionID: 'production',
          voice: {
            url: "https://runtime-api.voiceflow.com"
          }
        });
      }
      v.src = "https://cdn.voiceflow.com/widget-next/bundle.mjs"; v.type = "text/javascript"; s.parentNode.insertBefore(v, s);
  })(document, 'script');
</script>

</body>
</html>
